{
  "name": "Bot Comercial Principal",
  "nodes": [
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "telegram-webhook",
        "responseMode": "responseNode",
        "options": {}
      },
      "id": "webhook-telegram",
      "name": "Webhook Telegram",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 1,
      "position": [240, 300]
    },
    {
      "parameters": {
        "conditions": {
          "string": [
            {
              "value1": "={{$json.message.text}}",
              "operation": "contains",
              "value2": "/start"
            }
          ]
        }
      },
      "id": "check-start",
      "name": "√â comando /start?",
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [460, 300]
    },
    {
      "parameters": {
        "chatId": "={{$json.message.chat.id}}",
        "text": "Ol√°! Sou seu assistente comercial ü§ñ\n\nVoc√™ √©:\n‚Ä¢ Cliente existente\n‚Ä¢ Novo interessado\n\nDigite 1 ou 2 para continuar.",
        "additionalFields": {
          "reply_markup": {
            "inline_keyboard": [
              [
                {"text": "1Ô∏è‚É£ Cliente", "callback_data": "cliente"},
                {"text": "2Ô∏è‚É£ Novo", "callback_data": "novo"}
              ]
            ]
          }
        }
      },
      "id": "welcome-message",
      "name": "Mensagem Boas-vindas",
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1,
      "position": [680, 200]
    },
    {
      "parameters": {
        "conditions": {
          "string": [
            {
              "value1": "={{$json.callback_query.data}}",
              "operation": "equal",
              "value2": "novo"
            }
          ]
        }
      },
      "id": "check-novo",
      "name": "√â novo cliente?",
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [900, 300]
    },
    {
      "parameters": {
        "chatId": "={{$json.callback_query.message.chat.id}}",
        "text": "Perfeito! Qual servi√ßo voc√™ precisa?\n\nüîπ Consultoria\nüîπ Emerg√™ncia\nüîπ Auditoria\nüîπ Outro\n\nDigite o n√∫mero da op√ß√£o:",
        "additionalFields": {
          "reply_markup": {
            "inline_keyboard": [
              [
                {"text": "1Ô∏è‚É£ Consultoria", "callback_data": "consultoria"},
                {"text": "2Ô∏è‚É£ Emerg√™ncia", "callback_data": "emergencia"}
              ],
              [
                {"text": "3Ô∏è‚É£ Auditoria", "callback_data": "auditoria"},
                {"text": "4Ô∏è‚É£ Outro", "callback_data": "outro"}
              ]
            ]
          }
        }
      },
      "id": "servicos-menu",
      "name": "Menu de Servi√ßos",
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1,
      "position": [1120, 200]
    },
    {
      "parameters": {
        "conditions": {
          "string": [
            {
              "value1": "={{$json.callback_query.data}}",
              "operation": "equal",
              "value2": "emergencia"
            }
          ]
        }
      },
      "id": "check-emergencia",
      "name": "√â emerg√™ncia?",
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [1340, 300]
    },
    {
      "parameters": {
        "chatId": "={{$json.callback_query.message.chat.id}}",
        "text": "üö® EMERG√äNCIA DETECTADA!\n\nTransferindo para especialista...\nAguarde que algu√©m entrar√° em contato em at√© 5 minutos.\n\nüìû Ou ligue: +55 (31) 98606-3092"
      },
      "id": "emergencia-transfer",
      "name": "Transferir Emerg√™ncia",
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1,
      "position": [1560, 200]
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": "1BxiMVs0XRA5nFMdKvBdBZjgmUUqptlbs74OgvE2upms",
        "sheetName": "Leads",
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Timestamp": "={{new Date().toLocaleString()}}",
            "Nome": "={{$json.callback_query.from.first_name}}",
            "Username": "@{{$json.callback_query.from.username}}",
            "Tipo": "Emerg√™ncia",
            "Status": "Transferido",
            "ChatID": "={{$json.callback_query.message.chat.id}}"
          }
        },
        "options": {}
      },
      "id": "save-lead",
      "name": "Salvar no CRM",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 3,
      "position": [1780, 200]
    },
    {
      "parameters": {
        "chatId": "={{$json.callback_query.message.chat.id}}",
        "text": "√ìtimo! Para consultoria preciso de algumas informa√ß√µes:\n\nüìã Nome completo:\nüè¢ Nome da empresa:\nüì± Melhor hor√°rio para contato:\n\nPor favor, envie essas informa√ß√µes."
      },
      "id": "consultoria-form",
      "name": "Formul√°rio Consultoria",
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1,
      "position": [1560, 400]
    }
  ],
  "connections": {
    "Webhook Telegram": {
      "main": [
        [
          {
            "node": "√â comando /start?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "√â comando /start?": {
      "main": [
        [
          {
            "node": "Mensagem Boas-vindas",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Mensagem Boas-vindas": {
      "main": [
        [
          {
            "node": "√â novo cliente?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "√â novo cliente?": {
      "main": [
        [
          {
            "node": "Menu de Servi√ßos",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Menu de Servi√ßos": {
      "main": [
        [
          {
            "node": "√â emerg√™ncia?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "√â emerg√™ncia?": {
      "main": [
        [
          {
            "node": "Transferir Emerg√™ncia",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Formul√°rio Consultoria",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Transferir Emerg√™ncia": {
      "main": [
        [
          {
            "node": "Salvar no CRM",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": true,
  "settings": {},
  "versionId": "1"
}